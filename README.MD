# Программа для загрузки отчетов с сайта АТС (персональных и публичных)

## Для работы программы требуются следующие пакеты Python:
+ zipfile
+ glob
+ logging
+ requests

## Синтаксис:
python main.py параметр=значение

Виды параметров:
+ overwrite=true|false
Параметр определяет, нужно перезаписывать уже существующие на диске файлы отчетов или нет.
По умолчанию overwrite=false

+ dt=YYYYMMDD
 (например dt=20210910)
Параметр задает загрузку отчетов только за одну конкретную дату

+ dt1=YYYYMMDD (например dt1=20210910) или dt1=-x (например dt1=-10)
Загрузка отчетов с даты dt1 до даты dt2 (если она задана в параметрах) либо до текущей даты (если dt2 не задана).
Параметр может задаваться в виде конкретной даты в формате YYYYMMDD либо со смещением влево на x дней.

+ dt2=YYYYMMDD (например dt=20210910)
Загрузка отчетов до даты dt2
По умолчанию dt2 равен текущей дате

+ load_type=private|public
Загрузка персональных либо публичных отчетов.
По умолчанию load_type=private

+ partcode=[Код участника] (например partcode=part0001)
Код участника для загрузки
Можно коды задавать через запятую, например partcode=part0001,part0002,part0003.
Если не задан, то грузятся все участники, которые прописаны в настройках

+ reportcode=[Код отчета] (например reportcode=carana_sell_units)
Код отчета для загрузки. Можно задать несколько через запятую.
Если не задан, то грузятся все отчеты, которые имеются в настройках.

## Лог
Логирование осуществляется в файлы "LOG\YYYY-MM-DD_py_ats.log"

Как можно прочесть лог в powershell (например за январь 2022 года):
1) список загруженных файлов
Select-string "Log\2022-01*.log" -Pattern "file"
2) список ошибок
Select-string "Log\2022-01*.log" -Pattern "error"
3) время загрузки
Select-string "Log\2022-01*.log" -Pattern "complete"